<%=

  name = @p
  begin
    value = @resource.send(@p)
  rescue NoMethodError
    value = ''
  end

  html =''

  if name =~ /_id$/
    relation_name = name.to_s.gsub(/_id$/, '')

    if @resource.model.relation_keys_include? relation_name

      model = get_model_class relation_name.pluralize
      html += render_relationship_in_select model, name, value
    end

  else

    case Bowtie.config.fields_registry[@resource.send name]
    when "checkbox"
      checked = value == true ? 'checked="checked"' : ''
      html += '<input name="resource['+name.to_s+']" type="checkbox" '+checked+' />'
    when "textaera"
      html += '<textarea class="text" name="resource['+name.to_s+']"></textarea>'
    when "file"
      html += '<input type="file" name="resource['+name.to_s+']" size="chars">'
    else
      html += "#{Bowtie.config.fields_registry.inspect}"
      html += "#{value.inspect}"
      html += "<p>#{Bowtie.config.fields_registry[value.class.name]}</p>"
      html += '<input class="string" type="text" name="resource['+name.to_s+']" value="'+value.to_s+'" />'
    end

  end

  html
 %>
